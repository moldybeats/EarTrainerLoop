import pydub

MARKERS = {
    'C2': 0.000,
    'C#2': 2.053,
    'D2': 4.201,
    'D#2': 6.538,
    'E2': 8.683,
    'F2': 10.945,
    'F#2': 13.078,
    'G2': 15.411,
    'G#2': 17.576,
    'A2': 19.873,
    'A#2': 22.354,
    'B': 24.655,
    'C3': 27.077,
    'C#3': 30.006,
    'D3': 32.963,
    'D#3': 35.483,
    'E3': 38.861,
    'F3': 41.634,
    'F#3': 44.130,
    'G3': 46.833,
    'G#3': 49.205,
    'A3': 52.032,
    'A#3': 54.693,
    'B3': 57.478,
    'C4': 60.473,
    'C#4': 63.133,
    'D4': 65.758,
    'D#4': 68.871,
    'E4': 71.738,
    'F4': 74.983,
    'F#4': 78.224,
    'G4': 81.216,
    'G#4': 84.208,
    'A4': 87.035,
    'A#4': 90.277,
    'B4': 93.600,
    'C5': 96.595,
    'C#5': 99.131,
    'D5': 101.914,
    'D#5': 104.822,
    'E5': 108.188,
    'F5': 111.390,
    'F#5': 115.049,
    'G5': 118.497,
    'G#5': 122.070,
    'A5': 125.693,
    'A#5': 129.141,
    'B5': 132.258,
    'C6': 135.124,
    'C#6': 138.202,
    'D6': 141.361,
    'D#6': 144.310,
    'E6': 147.926,
    'F6': 151.503,
    'F#6': 155.118,
    'G6': 159.109,
    'G#6': 162.724,
    'A6': 166.629,
    'A#6': 170.787,
    'B6': 174.570,
}
LENGTH = 2.0

if __name__ == '__main__':
    notes = pydub.AudioSegment.from_wav('EarTrainer_pianonotes-all.wav')
    length_ms = LENGTH * 1000
    for note_name, offset in MARKERS.items():
        offset_ms = offset * 1000
        note = notes[offset_ms:offset_ms + length_ms]
        filename = note_name.replace('#', 'sh').replace('b', 'flat')
        note.export(f'{filename}.wav', format='wav')
    print('Done.')
